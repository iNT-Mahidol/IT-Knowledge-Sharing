# ฟังก์ชัน IF และ IFS ใน Excel: ตรวจสอบเงื่อนไข สร้างการตัดสินใจอัตโนมัติ

## บทนำ

ฟังก์ชัน `IF` เป็นหนึ่งในฟังก์ชันที่ทรงพลังที่สุดใน Excel ช่วยให้คุณสร้างการตัดสินใจอัตโนมัติโดยอิงตามเงื่อนไขที่กำหนด หากเงื่อนไขเป็นจริง ฟังก์ชันจะแสดงค่าหนึ่ง หากเงื่อนไขเป็นเท็จ ฟังก์ชันจะแสดงอีกค่าหนึ่ง การใช้งาน `IF` ช่วยให้คุณวิเคราะห์ข้อมูลและสร้างรายงานที่ยืดหยุ่นและมีประสิทธิภาพ

## การนำไปใช้

ฟังก์ชัน `IF` มีประโยชน์อย่างมากในหลายสถานการณ์ เช่น:

* **การให้คะแนน:** กำหนดเกรดตามคะแนนสอบ
* **การตรวจสอบเงื่อนไข:** ตรวจสอบว่ายอดขายถึงเป้าหมายหรือไม่
* **การคำนวณค่าคอมมิชชัน:** คำนวณค่าคอมมิชชันตามยอดขาย
* **การจัดกลุ่มข้อมูล:** จัดกลุ่มข้อมูลตามเงื่อนไขที่กำหนด

## ตัวอย่างการใช้งาน

### รูปแบบพื้นฐาน

`=IF(logical_test, value_if_true, value_if_false)`

* `logical_test`: เงื่อนไขที่ต้องการตรวจสอบ (เช่น A2 > 10)
* `value_if_true`: ค่าที่จะแสดงหากเงื่อนไขเป็นจริง
* `value_if_false`: ค่าที่จะแสดงหากเงื่อนไขเป็นเท็จ

### ตัวอย่าง 1: การให้คะแนน

สมมติว่าคุณมีคะแนนสอบในเซลล์ A2 และต้องการกำหนดเกรดดังนี้:

* คะแนน >= 80: เกรด A
* คะแนน >= 70: เกรด B
* คะแนน >= 60: เกรด C
* คะแนน < 60: เกรด F

**ตัวอย่างข้อมูล:** ([ดาวน์โหลดไฟล์ การให้คะแนน.xlsx](./assets/IF_Nested.xlsx))

| คะแนน (A) | เกรด (B) |
| :--------- | :------- |
| 85         | A        |
| 75         | B        |
| 60         | C        |
| 50         | F        |

**สูตรในเซลล์ B2:** `=IF(A2>=80, "A", IF(A2>=70, "B", IF(A2>=60, "C", "F")))`

**สูตรในเซลล์ B3:** `=IF(A3>=80, "A", IF(A3>=70, "B", IF(A3>=60, "C", "F")))`

**สูตรในเซลล์ B4:** `=IF(A4>=80, "A", IF(A4>=70, "B", IF(A4>=60, "C", "F")))`

**สูตรในเซลล์ B5:** `=IF(A5>=80, "A", IF(A5>=70, "B", IF(A5>=60, "C", "F")))`

### ตัวอย่าง 2: การตรวจสอบเงื่อนไข

สมมติว่าคุณมียอดขายในเซลล์ B2 และเป้าหมายยอดขายคือ 1000 ต้องการตรวจสอบว่ายอดขายถึงเป้าหมายหรือไม่

**ตัวอย่างข้อมูล:** ([ดาวน์โหลดไฟล์ การตรวจสอบเงื่อนไข.xlsx](./assets/IF_DisplayText.xlsx))

| ยอดขาย (A) | เป้าหมาย (B) | ผลลัพธ์ (C) |
| :--------- | :----------- | :----------- |
| 1200       | 1000         | ถึงเป้าหมาย   |
| 900        | 1000         | ไม่ถึงเป้าหมาย |

**สูตรในเซลล์ C2:** `=IF(A2>=B2, "ถึงเป้าหมาย", "ไม่ถึงเป้าหมาย")`

**สูตรในเซลล์ C3:** `=IF(A3>=B3, "ถึงเป้าหมาย", "ไม่ถึงเป้าหมาย")`

### ตัวอย่าง 3: การคำนวณค่าคอมมิชชัน

สมมติว่าคุณมียอดขายในเซลล์ C3 และต้องการคำนวณค่าคอมมิชชันดังนี้:

* ยอดขาย >= 5000: ค่าคอมมิชชัน 5%
* ยอดขาย < 5000: ค่าคอมมิชชัน 2%

**ตัวอย่างข้อมูล:** ([ดาวน์โหลดไฟล์ การคำนวณค่าคอมมิชชัน.xlsx](./assets/IF_Commision.xlsx))

| ยอดขาย (A) | คอมมิชชัน (B) |
| :--------- | :------------- |
| 6000       | 300            |
| 4000       | 80             |

**สูตรในเซลล์ B2:** `=IF(A2>=5000, A2*0.05, A2*0.02)`

**สูตรในเซลล์ B3:** `=IF(A3>=5000, A3*0.05, A3*0.02)`


### ฟังก์ชัน IFS

ฟังก์ชัน `IFS` เป็นฟังก์ชันที่ช่วยให้คุณตรวจสอบหลายเงื่อนไขได้ง่ายขึ้นโดยไม่ต้องใช้ฟังก์ชัน `IF` ซ้อนกันหลายชั้น ฟังก์ชันนี้จะตรวจสอบเงื่อนไขตามลำดับที่กำหนดและแสดงค่าที่ตรงกับเงื่อนไขแรกที่เป็นจริง

รูปแบบการใช้งาน:

`=IFS(logical_test1, value_if_true1, [logical_test2, value_if_true2], ...)`

* `logical_test1`: เงื่อนไขแรกที่ต้องการตรวจสอบ
* `value_if_true1`: ค่าที่จะแสดงหากเงื่อนไขแรกเป็นจริง
* `[logical_test2, value_if_true2]`: เงื่อนไขและค่าที่จะแสดงหากเงื่อนไขที่สองเป็นจริง (สามารถเพิ่มได้หลายคู่)

ตัวอย่าง:

สมมติว่าคุณมีคะแนนสอบในเซลล์ A2 และต้องการกำหนดเกรดดังนี้:

* คะแนน >= 80: เกรด A
* คะแนน >= 70: เกรด B
* คะแนน >= 60: เกรด C
* คะแนน < 60: เกรด F

**ตัวอย่างข้อมูล:** ([ดาวน์โหลดไฟล์ ตัวอย่าง_IFS.xlsx](./assets/IFS.xlsx))

| คะแนน (A) | เกรด (B) |
| :--------- | :------- |
| 85         | A        |
| 75         | B        |
| 60         | C        |
| 50         | F        |

**สูตรในเซลล์ B2:** `=IFS(A2>=80, "A", A2>=70, "B", A2>=60, "C", A2<60, "F")`

**สูตรในเซลล์ B3:** `=IFS(A3>=80, "A", A3>=70, "B", A3>=60, "C", A3<60, "F")`

**สูตรในเซลล์ B4:** `=IFS(A4>=80, "A", A4>=70, "B", A4>=60, "C", A4<60, "F")`

**สูตรในเซลล์ B5:** `=IFS(A5>=80, "A", A5>=70, "B", A5>=60, "C", A5<60, "F")`

ฟังก์ชัน `IFS` ช่วยให้สูตรดูเรียบร้อยและเข้าใจง่ายขึ้นเมื่อเทียบกับการใช้ฟังก์ชัน `IF` ซ้อนกันหลายชั้น

## เคล็ดลับเพิ่มเติม

* ใช้เครื่องหมายเปรียบเทียบ `>`, `<`, `>=`, `<=`, `=` เพื่อสร้างเงื่อนไข
* ใช้ฟังก์ชัน `AND` หรือ `OR` เพื่อรวมหลายเงื่อนไข ซึ่งจะต้องตรวจสอบทุกเงื่อนไขเพื่อให้ได้ผลลัพธ์ที่ถูกต้อง
* ใช้ฟังก์ชัน `NOT` เพื่อสลับค่าเงื่อนไข
* ใช้ฟังก์ชัน `ISBLANK` เพื่อตรวจสอบว่าเซลล์ว่างหรือไม่
* ใช้ฟังก์ชัน `IFERROR` เพื่อจัดการข้อผิดพลาดที่เกิดขึ้น
* ตรวจสอบวงเล็บให้ถูกต้องเมื่อใช้ฟังก์ชัน `IF` ซ้อนกัน